<h1>Метрический алгоритм разметки последовательностей</h1>

<p>Среди задач машинного обучения существует группа задач так называемой разметки последовательностей (sequence labeling).
Суть этих задач заключается в проставлении метки каждому элементу последовательности. 
При этом метка может зависеть не только от самого элемента, но и, в общем случае, от всех остальных элементов последовательности.</p>

<p>Для решения таких задач, в зависимости от способа описания элементов, можно использовать один из существующих алгоритмов.
Например, если в последовательности встречаются только элементы, принадлежащие конечному множеству элементов, то для решения такой задачи подойдут Скрытые Марковские Модели (HMM).
Если элемент можно описать в виде вектора действительных чисел, - подойдут Рекуррентные Нейронные Сети (RNN) или Случайные Условные Поля (CRF).</p>

<p>Однако, в том случае, когда элемент последовательности описывается более сложной структурой (деревом, множеством, графов и т.п.), применение указанных методов существенно усложняется.
В некоторых случаях элемент последовательности может быть описан не явно, а похожестью или расстоянием до других элементов.</p>

<p>Примером таких элементов могут служить концепты - понятия, смысловые значения имён или названий, встречающихся в текстах.
В качестве идентификатора концепта, например, может выступать URL Википедии, а описанием концепта - статья, находящаяся по ссылке.</p>

<p><img src="/img/concept.png" alt="Concept example" title="Concept example"></p>

<p>Довольно сложно предложить численное описание какого-либо концепта, однако способов сравнить их между собой довольно много.
Например можно посчитать число общих слов в статьях, описывающих два сравниваемых концепта.</p>

<p>Среди алгоритмов машинного обучения известны такие, которые в качестве входных дынных используют расстояния между классифицируемыми объектами.
Такие алгоритмы называют метрическими, среди них, например, существует алгоритм а k-nearest neighbours.</p>

<p>Напрямую, однако, применить kNN напрямую к последовательности элементов не получится, алгоритм не имеет возможности сохранить информацию о контексте.
Для применения метрических алгоритмов к последовательности данных рассмотрим способ обобщения алгоритма kNN.</p>

<p>Введем понятие состояния по аналогии с тем, как это сделано в алгоритме HMM с той лишь разницей, что пререход между состояниями осуществляется не в наиболее вероятное состояние, а в состояние, элементы которого оказались ближе к текущему классифицируемому.</p>

<p>Рассмотрим для наглядности анимацию классификации точек на плоскости:</p>

<div class="sknn_animation">
</div>

<script src="/js/force.js" type="text/javascript"></script>

<p>Показанный процесс соответствует жадному методу классификации: он минимизирует расстояние лишь на каждом отдельном шаге.
Для более точной классификации необходимо минимизировать суммарное расстояние классификации всех элементов последовательности.</p>

<p>По аналогии с HMM, в модифицированном алгоритме kNN (будем называть его Structured kNN, SkNN) используется модифицированный алгоритм Витерби, отличающий от оригинального тем, что вместо максимизации произведения вероятностей производится минимизация суммарного расстояния.</p>

<p>Алгоритм SkNN может быть использован не только для разметки элементов последовательностей, но и для классификации последовательностей в целом.
Для этого, в прочем, все равно необходимо указать класс каждого отдельного элемента последовательности, но этот процесс может быть выполнен автоматически с помощью кластеризации.</p>

<p>Для классификации последовательностей необходимо сформировать граф состояний отдельно для каждого класса, а затем объединить их в один способом, показанным на рисунке:</p>

<p><img src="/img/sknn_class.png" alt="Classification with SkNN" title="Classification with SkNN"></p>

<p>После запуска алгоритма на тестовой последовательности, ее класс можно будет определить в соответствии с тем, состояния какой из ветвей графа были использованы для разметки.</p>

<p>В настоящее время я веду провожу попытки применить алгоритм SkNN для решения задачи Named Entity Linking,
и уже накопилось много инересного материала. Надеюсь в скором времни здесь появятся заметки об использовании DBpedia совмесно с SkNN и обогщении датасета для решения задачи NEL.</p>

<h2>Больше о SkNN</h2>

<ul>
<li><a href="https://arxiv.org/abs/1610.04718">Generalization of metric classification algorithms for sequences classification and labelling</a> on arXiv.org [English]</li>
<li><a href="/sknn.pdf">Статья</a> на русском. </li>
<li>OpenSource реализация на Github

<ul>
<li><a href="https://github.com/generall/sknn-scala">Scala</a></li>
<li><a href="https://github.com/generall/SkNN-ruby">Ruby</a></li>
<li><a href="https://github.com/generall/SkNN-java">java, weka</a></li>
</ul></li>
</ul>
